{
  "id": "events-lifecycle",
  "title": "Lifecycle Events",
  "slug": "events-lifecycle",
  "version": "build-41",
  "section": "modding",
  "category": "lua-api",
  "tags": ["events", "lifecycle", "initialization", "save", "load", "time", "intermediate"],
  "excerpt": "Complete reference for game lifecycle events: boot, start, save, load, and time-based events.",
  "lastUpdated": "2026-01-10",
  "difficulty": "intermediate",
  "tableOfContents": [
    { "id": "overview", "text": "Overview", "level": 2 },
    { "id": "game-boot-events", "text": "Game Boot Events", "level": 2 },
    { "id": "game-start-events", "text": "Game Start Events", "level": 2 },
    { "id": "save-load-events", "text": "Save/Load Events", "level": 2 },
    { "id": "time-events", "text": "Time Events", "level": 2 },
    { "id": "event-order", "text": "Event Order", "level": 2 },
    { "id": "common-patterns", "text": "Common Patterns", "level": 2 },
    { "id": "related", "text": "Related", "level": 2 }
  ],
  "content": "# Lifecycle Events\n\n## Overview\n\nLifecycle events control the flow of your mod from game boot to shutdown. Understanding when each event fires is crucial for proper initialization and cleanup.\n\n---\n\n## Game Boot Events\n\n### OnGameBoot\n**When:** Game executable starts, before main menu\n**Parameters:** None\n**Use Case:** Early mod initialization, global setup before anything else loads\n\n```lua\nEvents.OnGameBoot.Add(function()\n    print(\"Game is booting up\")\n    -- Initialize global mod data\n    -- Register custom Lua events\n    -- Set up global tables\nend)\n```\n**Files that listen:** 14+ vanilla files\n\n---\n\n### OnMainMenuEnter\n**When:** Main menu screen is displayed\n**Parameters:** None\n**Use Case:** Menu modifications, pre-game setup, mod version checks\n\n```lua\nEvents.OnMainMenuEnter.Add(function()\n    print(\"Entered main menu\")\n    -- Add custom menu buttons\n    -- Check for mod updates\nend)\n```\n**Files that listen:** 8+ vanilla files\n\n---\n\n### OnPreMapLoad\n**When:** Before map data loads\n**Parameters:** None\n**Use Case:** Map preparation, custom map data loading\n\n```lua\nEvents.OnPreMapLoad.Add(function()\n    -- Prepare custom map data\nend)\n```\n\n---\n\n### OnInitWorld\n**When:** World is initializing\n**Parameters:** None\n**Use Case:** World data setup before game starts\n\n```lua\nEvents.OnInitWorld.Add(function()\n    -- Initialize world-level mod data\nend)\n```\n\n---\n\n## Game Start Events\n\n### OnGameStart\n**When:** New game starts OR save is loaded, player is ready\n**Parameters:** None\n**Use Case:** **Most common initialization point for mods**\n\n```lua\nEvents.OnGameStart.Add(function()\n    local player = getPlayer()\n    print(\"Game started for\", player:getUsername())\n    \n    -- Initialize your mod\n    -- Setup UI elements\n    -- Load saved mod data\nend)\n```\n**Files that listen:** 39+ vanilla files (MOST USED EVENT)\n\n---\n\n### OnNewGame\n**When:** New game is created (NOT on load)\n**Parameters:** `player` (IsoPlayer), `square` (IsoGridSquare)\n**Use Case:** First-time setup, starter items, initial mod state\n\n```lua\nEvents.OnNewGame.Add(function(player, square)\n    -- Give starter items (only on new game)\n    player:getInventory():AddItem(\"Base.Hammer\")\n    \n    -- Initialize fresh mod data\n    player:getModData().myMod = {\n        firstPlaythrough = true,\n        startDay = getGameTime():getDay()\n    }\nend)\n```\n\n---\n\n### OnCreatePlayer\n**When:** Player character is created\n**Parameters:** `playerIndex` (int), `player` (IsoPlayer)\n**Use Case:** Player-specific initialization, per-player data setup\n\n```lua\nEvents.OnCreatePlayer.Add(function(playerIndex, player)\n    print(\"Player\", playerIndex, \"created:\", player:getUsername())\n    \n    -- Initialize player-specific data\n    local modData = player:getModData()\n    modData.myMod = modData.myMod or {\n        level = 1,\n        experience = 0\n    }\nend)\n```\n\n---\n\n### OnGameTimeLoaded\n**When:** Game time data is loaded\n**Parameters:** None\n**Use Case:** Time-dependent initialization\n\n```lua\nEvents.OnGameTimeLoaded.Add(function()\n    local time = getGameTime()\n    print(\"World age:\", time:getWorldAgeHours(), \"hours\")\n    print(\"Current day:\", time:getDay())\nend)\n```\n\n---\n\n## Save/Load Events\n\n### OnSave\n**When:** Game is being saved\n**Parameters:** None\n**Use Case:** Persist mod data to save file\n\n```lua\nEvents.OnSave.Add(function()\n    -- Save mod data using ModData\n    local data = ModData.getOrCreate(\"MyMod\")\n    data.lastSave = getGameTime():getWorldAgeHours()\n    data.settings = MyMod.settings\n    data.state = MyMod.state\nend)\n```\n\n---\n\n### OnPostSave\n**When:** After game save completes\n**Parameters:** None\n**Use Case:** Post-save cleanup, confirmation messages\n\n```lua\nEvents.OnPostSave.Add(function()\n    print(\"Save complete!\")\nend)\n```\n\n---\n\n### OnResetLua\n**When:** Lua state is reset (debug/reload)\n**Parameters:** `reason` (string)\n**Use Case:** Re-initialization after Lua reload, cleanup\n\n```lua\nEvents.OnResetLua.Add(function(reason)\n    print(\"Lua reset:\", reason)\n    -- Re-register event handlers\n    -- Reinitialize state\nend)\n```\n\n---\n\n## Time Events\n\n### OnTick\n**When:** Every game tick (most frequent)\n**Parameters:** `tick` (double)\n**Use Case:** High-frequency updates (use sparingly!)\n\n```lua\n-- WARNING: This runs every frame (30-60 times/second)\nlocal tickCounter = 0\nEvents.OnTick.Add(function(tick)\n    tickCounter = tickCounter + 1\n    if tickCounter >= 60 then  -- ~1 second\n        tickCounter = 0\n        -- Do periodic work\n    end\nend)\n```\n**Files that listen:** 31+ vanilla files\n\n---\n\n### OnTickEvenPaused\n**When:** Every tick, even when game is paused\n**Parameters:** `tick` (double)\n**Use Case:** UI updates during pause, background processing\n\n---\n\n### OnRenderTick\n**When:** Every render frame\n**Parameters:** None\n**Use Case:** Visual effects, UI updates that need to sync with rendering\n\n---\n\n### EveryOneMinute\n**When:** Every in-game minute\n**Parameters:** None\n**Use Case:** Periodic updates without performance impact\n\n```lua\nEvents.EveryOneMinute.Add(function()\n    local player = getPlayer()\n    if player and player:isOutside() then\n        -- Check weather effects once per minute\n        checkWeatherEffects(player)\n    end\nend)\n```\n\n---\n\n### EveryTenMinutes\n**When:** Every 10 in-game minutes\n**Parameters:** None\n**Use Case:** Less frequent periodic updates\n\n```lua\nEvents.EveryTenMinutes.Add(function()\n    -- Update hunger effects\n    -- Process pending crafts\nend)\n```\n\n---\n\n### EveryHours\n**When:** Every in-game hour\n**Parameters:** None\n**Use Case:** Hourly updates, resource regeneration\n\n```lua\nEvents.EveryHours.Add(function()\n    local time = getGameTime()\n    print(\"Hour:\", time:getHour(), \"Day:\", time:getDay())\nend)\n```\n\n---\n\n### EveryDays\n**When:** Every in-game day\n**Parameters:** None\n**Use Case:** Daily updates, respawning, statistics\n\n```lua\nEvents.EveryDays.Add(function()\n    local day = getGameTime():getDay()\n    print(\"Day\", day, \"has begun\")\n    -- Daily reset\n    -- Respawn resources\nend)\n```\n\n---\n\n### OnDawn\n**When:** Dawn begins\n**Parameters:** None\n**Use Case:** Morning events, light-dependent features\n\n```lua\nEvents.OnDawn.Add(function()\n    print(\"The sun is rising\")\nend)\n```\n**Triggered in:** `season.lua:322`\n\n---\n\n### OnDusk\n**When:** Dusk begins\n**Parameters:** None\n**Use Case:** Evening events, night preparation\n\n```lua\nEvents.OnDusk.Add(function()\n    print(\"Night is coming\")\nend)\n```\n**Triggered in:** `season.lua:318`\n\n---\n\n## Event Order\n\nUnderstanding the order events fire is crucial:\n\n### Game Boot Sequence\n```\n1. OnGameBoot           ← Game executable starts\n2. OnMainMenuEnter      ← Main menu displayed\n3. [Player creates/loads game]\n4. OnPreMapLoad         ← Before map loads\n5. OnInitWorld          ← World initializing\n6. OnGameTimeLoaded     ← Time data ready\n7. OnCreatePlayer       ← Player created\n8. OnNewGame (if new)   ← Only on new game\n9. OnGameStart          ← Player ready to play\n```\n\n### Save Sequence\n```\n1. OnSave               ← Save begins\n2. [Game writes data]\n3. OnPostSave           ← Save complete\n```\n\n### Time Event Frequency\n```\nOnTick              ← Every frame (~60/sec)\nOnRenderTick        ← Every render frame\nEveryOneMinute      ← Every in-game minute\nEveryTenMinutes     ← Every 10 in-game minutes\nEveryHours          ← Every in-game hour\nEveryDays           ← Every in-game day\nOnDawn/OnDusk       ← Specific times of day\n```\n\n---\n\n## Common Patterns\n\n### Initialization with Save Support\n\n```lua\nlocal MyMod = {}\n\n-- Initialize on game start\nEvents.OnGameStart.Add(function()\n    -- Load saved data or create new\n    local saved = ModData.getOrCreate(\"MyMod\")\n    MyMod.data = saved.data or {}\n    MyMod.settings = saved.settings or { enabled = true }\n    MyMod.initialized = true\nend)\n\n-- New game specific setup\nEvents.OnNewGame.Add(function(player, square)\n    MyMod.data = {\n        startDay = getGameTime():getDay(),\n        totalKills = 0\n    }\nend)\n\n-- Save data\nEvents.OnSave.Add(function()\n    if MyMod.initialized then\n        local saved = ModData.getOrCreate(\"MyMod\")\n        saved.data = MyMod.data\n        saved.settings = MyMod.settings\n    end\nend)\n```\n\n### Throttled Updates\n\n```lua\nlocal lastUpdate = 0\nlocal UPDATE_INTERVAL = 60  -- 60 ticks = ~1 second\n\nEvents.OnTick.Add(function(tick)\n    lastUpdate = lastUpdate + 1\n    if lastUpdate >= UPDATE_INTERVAL then\n        lastUpdate = 0\n        -- Do your periodic work here\n        performUpdate()\n    end\nend)\n\n-- OR use EveryOneMinute for better performance\nEvents.EveryOneMinute.Add(function()\n    performUpdate()\nend)\n```\n\n### Multi-Stage Initialization\n\n```lua\nlocal MyMod = { stage = 0 }\n\nEvents.OnGameBoot.Add(function()\n    MyMod.stage = 1\n    -- Register global data\nend)\n\nEvents.OnMainMenuEnter.Add(function()\n    MyMod.stage = 2\n    -- Setup menu elements\nend)\n\nEvents.OnGameStart.Add(function()\n    MyMod.stage = 3\n    -- Full initialization\nend)\n```\n\n---\n\n## Related\n\n- [Events Overview](/build-41/modding/lua-api/events-overview) - Introduction to events\n- [Player Events](/build-41/modding/lua-api/events-player) - Player-specific events\n- [Timed Actions](/build-41/modding/lua-api/timed-actions) - Custom action system"
}
